<template>

  <main>
    <!-- new banner-->
    <section class="banner mini">
      <div class="container">
        <!-- lbl-->
        <div class="bannertext">
          <div class="line">
            <div class="lbl"> <span>CAMPAIGN</span></div>
            <div class="wrap"><span>${campaign.title}</span></div>
          </div>
        </div>
        <!-- vertical nav-->
        <nav class="vertical">
          <ul>
            <li><a href="/">RETURN TO CAMPAIGN LIST <img src="/img/ic-arrow-right-black.png"></a></li>
          </ul>
        </nav>
        <!-- progress-->
        <div class="progress">
          <div role="progressbar" aria-valuenow="${campaign.percentage}" aria-valuemin="0" aria-valuemax="100" style="width: ${campaign.percentage}%;" class="progress-bar">
            <div class="labl">${campaign.percentage}%</div>
          </div>
        </div>
        <!-- bg-->
        <div class="bgwrap" style="background-image: url('${campaign.banner}');"></div>
      </div>
    </section>
    <!-- campaign info-->
    <section class="campaigninfo">
      <div class="container">
        <!-- left-->
        <div class="left">

          <!-- wrap-->
          <div class="wrap">
            <!-- badge-->
            <div class="badges" if.bind="isAuthenticated"><img src.bind="userBadge"></div>
            <!-- badge-->
            <div class="badges" if.bind="!isAuthenticated"><img src="/img/badges.png"></div>
            <!-- user stat-->
            <div class="userstat" if.bind="isAuthenticated">
              <!-- text-->
              <h1 if.bind="userPoints >= campaign.badges.bronze">Congratulations ${user.firstName}!<br/>
                You have unlocked the ${userBadgeName} badge.</h1>
              <h1 if.bind="userPoints<campaign.badges.bronze && userPoints>0">Hello ${user.firstName}!<br/>
                Continue contributing to earn your first badge.</h1>
              <h1 if.bind="userPoints<campaign.badges.bronze && userPoints==0">Hello ${user.firstName}!<br/>
                Start contributing to earn your first badge.</h1>
              <!-- stats-->
              <ul class="stats" if.bind="userPoints>0">
                <li class="wide">
                  <div class="lbl">TAGS</div>
                  <div class="val">${userTags}</div>
                </li>
                <li>
                  <div class="lbl">ITEMS</div>
                  <div class="val">${userRecords}</div>
                </li>
                <li>
                  <div class="lbl">BADGE</div>
                  <div class="val">${userBadgeName}</div>
                </li>
                <li class="wide">
                  <div class="lbl">CAMPAIGN RANK</div>
                  <div class="val">${userRank}</div>
                </li>
                <li class="wide">
                  <div class="lbl">POINTS</div>
                  <div class="val">${userPoints}</div>
                </li>
              </ul>
              <!-- description-->
              <div class="desc">
                Contribute more and unlock new badges. <br/>You can find the general statistics regarding the campaign <a href="javascript:void(0)" click.delegate="scrollTo('#maps')">below.</a>
              </div>
            </div>
            <!-- user stat-->
            <div class="userstat" if.bind="!isAuthenticated">
              <!-- text-->
              <h1>Get involved!<br/>
                Join CrowdHeritage and start contributing to our crowdsourcing campaigns.</h1>
              <!-- description-->
              <div class="desc">
                Start annotating and unlock new badges. <br/>You can find the general statistics regarding the campaign <a href="javascript:void(0)" click.delegate="scrollTo('#maps')">below.</a>
              </div>
            </div>
          </div>

        </div>
        <!-- right-->
        <div class="right">
          <!-- wrap-->
          <div class="wrap">
            <!-- tet-->
            <div class="text">
              <!-- heading-->
              <div class="heading"> <span>GOAL</span></div>
              <!-- desc-->
              <p>${campaign.description}</p>
              <!-- stats-->
              <ul class="stats">
                <li>
                  <div class="lbl">START DATE</div>
                  <div class="val">${campaign.startDate | dateFormat}</div>
                  <br/>
                  <div class="lbl">CONTRIBUTORS</div>
                  <div class="val">${campaign.contributorsCount}</div>
                </li>
                <li>
                  <div class="lbl">END DATE</div>
                  <div class="val">${campaign.endDate | dateFormat}</div>
                  <br/>
                  <div class="lbl">PROGRESS</div>
                  <div class="val">
                    ${campaign.percentage}%<small>${campaign.totalCurrent}/${campaign.target}</small>
                  </div>
                </li>
              </ul>
            </div>
          </div>
          <!-- contribute-->
          <div class="contribute"><a href="javascript:void(0)" click.delegate="goToItem(campaign, 0, records, 0)">CONTRIBUTE TO CAMPAIGN</a></div>
        </div>
      </div>
    </section>
    <!-- collection list-->
    <section class="collections">
      <div class="container">
        <!-- top section-->
        <div class="topsection">
          <!-- label-->
          <div class="sectionlabel">
            <div class="bold">COLLECTIONS</div><span>SELECT TO CONTRIBUTE</span>
          </div>
        </div>
        <!-- campaign reel-->
        <div class="campaignlist">
          <!-- entry-->
          <div class="entries row" ref="grid" >
            <!-- item-->
            <!-- entry-->

            <div class="entry col-md-4 ${col.dbId}" repeat.for="col of collections">
              <!-- wrap-->
							<a route-href="route: collection; params.bind: { cname: campaign.username, colid: col.dbId }">
								<!-- thumb-->
								<div class="thumbs">
									<div class="thumbs-images thumbs-count-${col.absMedia.length}">
										<img repeat.for="med of col.absMedia" src.bind="med" onError="this.src='/img/assets/img/ui/ic-noimage.png'" />
									</div>
									<div class="action"><span class="plus">+ </span>CONTRIBUTE NOW</div>
								</div>
                <!-- detail-->
                <div class="detail">
                  <!-- count-->
                  <div class="count">
                    ${col.entryCount}<span>ITEMS</span>
                  </div>
                  <!-- title-->
                  <div class="desc">
                    <div class="title">${col.title}</div>
                    <div class="owner"><i>Curated by <b>${col.creatorName}</b></i></div>
                  </div>
                </div></a>
            </div>

          </div>
          <!-- more-->
          <div class="loadmore">
            <a href="#" show.bind="!loading && more" click.delegate="loadMore()">LOAD MORE</a>
            <div class="more"><i show.bind="loading" class="fa fa-spinner fa-pulse"></i></div>
          </div>
        </div>
      </div>
    </section>

    <!-- campaign stats-->
    <section class="campaignstats">
      <!-- conty-->
      <div class="container">
        <!-- maps-->
        <div class="left">
          <!-- maps-->
          <div class="maps">
            <div id="maps" class="mapswrap">
            <compose view-model="widgets/googlemap/googlemap"></compose>
            </div>
            <!-- heading-->
            <div class="heading">Location of Active Volunteers</div>
          </div>
          <!-- graphs-->
         <compose view-model="widgets/graph/graph" model.bind="{ 'campaign': campaign, 'points': points}"></compose>
        </div>
        <div class="right">
          <!-- leaderboard-->
          <compose view-model="widgets/leaderboard/leaderboard" model.bind="{ 'campaign': campaign, 'points': points}"></compose>
        </div>
      </div>
    </section>
  </main>
</template>
